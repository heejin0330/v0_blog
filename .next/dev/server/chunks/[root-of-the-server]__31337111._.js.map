{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/PJT_JAEHAN/v0_blog/app/api/content/generate/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\n\n// 1. Google Gemini 클라이언트 설정\nconst apiKey =\n  process.env.GEMINI_API_KEY ||\n  process.env.GOOGLE_GEMINI_API_KEY ||\n  process.env.GOOGLE_API_KEY ||\n  \"\";\n\nif (!apiKey) {\n  console.error(\n    \"Gemini API 키가 설정되지 않았습니다. .env.local 파일을 확인해주세요.\"\n  );\n}\n\nconst genAI = new GoogleGenerativeAI(apiKey);\n\n// 섹션 타입 정의\ninterface Section {\n  type: \"h1\" | \"h2\" | \"h3\" | \"p\" | \"ul\" | \"blockquote\";\n  content: string | string[];\n}\n\n// AI 응답 인터페이스 정의\ninterface AIOutput {\n  title: string;\n  excerpt: string;\n  tags: string[];\n  sections: Section[];\n}\n\n// [핵심 함수] JSON 데이터를 워드프레스 구텐베르크 블록 포맷으로 변환\nfunction convertToWPBlocks(sections: Section[]): string {\n  return sections\n    .map((section) => {\n      switch (section.type) {\n        case \"h1\":\n          return `\\n<h1>${String(section.content)}</h1>\\n`;\n        case \"h2\":\n          return `\\n<h2>${String(section.content)}</h2>\\n`;\n        case \"h3\":\n          return `\\n<h3>${String(section.content)}</h3>\\n`;\n        case \"p\":\n          return `\\n<p>${String(section.content)}</p>\\n`;\n        case \"blockquote\":\n          return `\\n<blockquote class=\"wp-block-quote\"><p>${String(\n            section.content\n          )}</p></blockquote>\\n`;\n\n        // ▼▼▼ [수정 1] 리스트 점(Bullet) 오류 해결 로직 ▼▼▼\n        case \"ul\":\n          let items: string[] = [];\n\n          if (Array.isArray(section.content)) {\n            items = section.content;\n          } else {\n            // 문자열로 온 경우 줄바꿈으로 분리\n            items = String(section.content).split(\"\\n\");\n          }\n\n          const listItems = items\n            .map((item) => String(item).trim()) // 1. 앞뒤 공백 제거\n            .filter((item) => item.length > 0) // 2. 빈 줄(내용 없는 점) 제거\n            .map((item) => {\n              // 3. AI가 텍스트 앞에 붙인 기호(-, *, •) 제거 (이중 점 방지)\n              const cleanItem = item.replace(/^[-•*]\\s*/, \"\");\n              return `<li>${cleanItem}</li>`;\n            })\n            .join(\"\");\n\n          return `\\n<ul>${listItems}</ul>\\n`;\n        // ▲▲▲ [수정 끝] ▲▲▲\n\n        default:\n          return `\\n<p>${String(section.content)}</p>\\n`;\n      }\n    })\n    .join(\"\\n\\n\");\n}\n\n// SEO 점수 계산 함수\nfunction calculateSEOScore(\n  title: string,\n  metaDescription: string,\n  content: string,\n  images: Array<{ alt: string; url?: string }>,\n  keywords: string[]\n): number {\n  let score = 0;\n  const maxScore = 100;\n\n  // keywords[0]은 가장 중요한 '공식 모델명'\n  const primaryKeyword = keywords[0] || \"\";\n\n  // 1. 제목 길이 (30-60자)\n  if (title.length >= 30 && title.length <= 60) score += 10;\n  else if (title.length > 20 && title.length < 70) score += 7;\n  else score += 3;\n\n  // 2. 제목 키워드 포함\n  if (\n    primaryKeyword &&\n    title.toLowerCase().includes(primaryKeyword.toLowerCase())\n  )\n    score += 10;\n\n  // 3. 메타 설명 길이 (120-160자)\n  if (metaDescription.length >= 120 && metaDescription.length <= 160)\n    score += 15;\n  else if (metaDescription.length > 50) score += 7;\n\n  // 4. 콘텐츠 길이 (애드센스 타겟: 1500자 이상 권장)\n  const contentText = content.replace(/<[^>]*>/g, \"\");\n  if (contentText.length >= 1500) score += 20;\n  else if (contentText.length >= 1000) score += 15;\n  else if (contentText.length >= 500) score += 10;\n  else score += 2;\n\n  // 5. 헤딩 태그 구조\n  const h2Count = (content.match(/<h2/g) || []).length;\n  if (h2Count >= 3) score += 10;\n\n  // 6. 이미지 유무\n  if (images.length > 0) score += 10;\n\n  // 7. 키워드 밀도 (본문에 키워드가 있는지)\n  if (\n    primaryKeyword &&\n    contentText.toLowerCase().includes(primaryKeyword.toLowerCase())\n  )\n    score += 10;\n\n  return Math.min(Math.round(score), maxScore);\n}\n\nexport async function POST(req: Request) {\n  try {\n    if (!apiKey) {\n      return NextResponse.json(\n        { success: false, error: \"API Key Missing\" },\n        { status: 500 }\n      );\n    }\n\n    const {\n      modelName,\n      modelAlias,\n      templateType,\n      includeImages,\n      modelInfo,\n      tone = \"informative\",\n      depth = \"deep\",\n      customSearchContext,\n    } = await req.json();\n\n    if (!modelName) {\n      return NextResponse.json(\n        { success: false, error: \"모델명이 없습니다.\" },\n        { status: 400 }\n      );\n    }\n\n    // ---------------------------------------------------------\n    // [수정 2] 이름 변수 분리 (닉네임 오버라이딩 방지)\n    // ---------------------------------------------------------\n    const officialName = modelName; // 예: Rolex Submariner 126610LV\n    const nickname = modelAlias; // 예: 스타벅스\n    const brand = modelInfo?.brand || \"Brand\";\n\n    // ---------------------------------------------------------\n    // STEP 1: 검색 (Tavily) - 공식 모델명 기준\n    // ---------------------------------------------------------\n    console.log(`[1/3] Searching for: ${officialName}...`);\n    const tavilyApiKey = process.env.TAVILY_API_KEY;\n    let searchContext = \"\";\n    // 1. 사용자가 직접 검수한 데이터가 있으면 그걸 최우선으로 사용\n    if (customSearchContext && customSearchContext.length > 0) {\n      console.log(`[1/3] Using curated search context from frontend.`);\n      searchContext = customSearchContext;\n    }\n    // 2. 없으면 기존처럼 백엔드에서 직접 검색 (Fallback)\n    else {\n      console.log(`[1/3] Searching via Tavily (Fallback)...`);\n      const tavilyApiKey = process.env.TAVILY_API_KEY;\n\n      if (tavilyApiKey) {\n        try {\n          const searchResponse = await fetch(\"https://api.tavily.com/search\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n              api_key: tavilyApiKey,\n              // 검색은 정확도를 위해 '공식 명칭'으로 수행\n              query: `${brand} ${officialName} review history specs price pros cons`,\n              search_depth: \"basic\",\n              include_answer: true,\n              max_results: 5,\n            }),\n          });\n\n          if (searchResponse.ok) {\n            const searchData = await searchResponse.json();\n            if (searchData.results) {\n              searchContext = searchData.results\n                .map((r: any) => `[Source: ${r.title}] ${r.content}`)\n                .join(\"\\n\\n\");\n            }\n          }\n        } catch (e) {\n          console.warn(\"Search failed, proceeding without it.\");\n        }\n      }\n    } // end fallback search block\n\n    // ---------------------------------------------------------\n    // STEP 2: 프롬프트 엔지니어링 (Tone, Depth, SEO Name 반영)\n    // ---------------------------------------------------------\n    console.log(`[2/3] Generating content (Tone: ${tone}, Depth: ${depth})...`);\n\n    // 어조 설정\n    const toneInstructions: Record<string, string> = {\n      informative: \"객관적이고 전문적인 저널리스트 톤 ('~합니다/습니다' 체)\",\n      storytelling:\n        \"오래된 시계 수집가의 경험담 톤, 감성적 표현 포함 ('~해요/하죠' 체)\",\n      critical: \"날카롭고 분석적인 평론가 톤, 장단점을 명확히 구분 ('~다' 체)\",\n      friendly:\n        \"친절한 이웃 형/오빠가 설명해주는 톤 ('~야/해' 반말 모드 혹은 친근한 존댓말)\",\n    };\n\n    // 깊이 설정\n    const depthInstruction =\n      depth === \"deep\"\n        ? `\n        [분량 및 깊이 필수]\n        - 반드시 전체 글자 수(공백 제외) 1,500자 이상 작성할 것.\n        - 단순 스펙 나열을 넘어 '왜 이 스펙이 중요한지' 분석할 것.\n        - 마지막에 '자주 묻는 질문(FAQ)' 섹션을 h2로 만들고 3가지 질문/답변을 포함할 것.\n      `\n        : `[분량] 핵심 위주로 간결하게 800자 내외로 작성할 것.`;\n\n    const systemInstruction = `\n      당신은 대한민국 최고의 빈티지 시계 전문 에디터입니다.\n      \n      [작성 목표]\n      - 주제: ${officialName} ${nickname ? `(별칭: ${nickname})` : \"\"}\n      - 브랜드: ${brand}\n      - 타겟 독자: 시계 구매를 고려하거나 정보를 찾는 3040 남성\n      - 톤앤매너: ${toneInstructions[tone] || toneInstructions[\"informative\"]}\n      \n      [강력한 SEO 필수 지침 (중요)]\n      1. **제목**: 반드시 '${officialName}'(공식 모델명)과 '${nickname}'(별칭)을 자연스럽게 섞어서 작성할 것. (예: 롤렉스 ${officialName} '${nickname}' 완벽 리뷰)\n      2. **본문**: \n         - 글의 시작 부분(Intro)에 정확한 모델명(${officialName})을 명시할 것.\n         - 본문 중간중간에 별칭(${nickname})을 자연스럽게 섞어 쓰되, 검색 엔진이 정확한 모델을 인식하도록 공식 명칭을 최소 3회 이상 언급할 것.\n      \n      ${depthInstruction}\n\n      [필수 구조 (JSON 포맷)]\n      반드시 아래 JSON 형식을 지키세요. 마크다운 코드 블록 없이 순수 JSON만 반환하세요.\n      {\n        \"title\": \"SEO 최적화된 제목\",\n        \"excerpt\": \"구글 검색 결과용 150자 요약\",\n        \"tags\": [\"키워드1\", \"키워드2\"],\n        \"sections\": [\n          { \"type\": \"h1\", \"content\": \"제목\" },\n          { \"type\": \"p\", \"content\": \"서론...\" },\n          { \"type\": \"ul\", \"content\": [\"항목1\", \"항목2\"] },\n          ...\n        ]\n      }\n    `;\n\n    const userPrompt = `\n      공식 모델명: ${officialName}\n      별칭(닉네임): ${nickname || \"없음\"}\n      브랜드: ${brand}\n      참고 데이터(검색결과): ${searchContext}\n      \n      위 정보를 바탕으로 구글 애드센스 승인을 받을 수 있는 고품질의 긴 글을 작성해줘.\n      '${officialName}'이 메인 키워드로 잡히도록 신경 써서 작성해.\n    `;\n\n    // Gemini 모델 호출\n    let modelOptions = [\n      \"gemini-2.0-flash\",\n      \"gemini-1.5-pro\",\n      \"gemini-1.5-flash\",\n      \"gemini-pro\",\n    ];\n    let aiOutput: AIOutput | null = null;\n\n    for (const modelNameOption of modelOptions) {\n      try {\n        const model = genAI.getGenerativeModel({\n          model: modelNameOption,\n          generationConfig: { responseMimeType: \"application/json\" },\n          systemInstruction: systemInstruction,\n        });\n\n        const result = await model.generateContent(userPrompt);\n        aiOutput = JSON.parse(result.response.text());\n        if (aiOutput?.sections) break;\n      } catch (e: any) {\n        console.warn(`Model ${modelNameOption} failed:`, e.message);\n        if (e.message.includes(\"429\")) continue;\n        if (e.message.includes(\"404\")) continue;\n      }\n    }\n\n    if (!aiOutput) {\n      throw new Error(\"모든 AI 모델 생성 실패. API 키나 할당량을 확인하세요.\");\n    }\n\n    // ---------------------------------------------------------\n    // STEP 3: 결과 변환 및 반환\n    // ---------------------------------------------------------\n    console.log(`[3/3] Converting results...`);\n\n    const blockContent = convertToWPBlocks(aiOutput.sections);\n\n    // 이미지 처리 (placeholder)\n    const images = includeImages\n      ? [\"front\", \"side\", \"back\"].map((type) => ({\n          url: `/placeholder.svg?height=400&width=400&query=${encodeURIComponent(\n            `${officialName} watch ${type}`\n          )}`,\n          alt: `${officialName} ${type}`,\n        }))\n      : [];\n\n    // [수정 3] SEO 키워드 로직 보강\n    const seoKeywords = [\n      officialName, // 1순위: 공식 모델명 (가장 중요)\n      `${brand} ${officialName}`, // 2순위: 브랜드 + 모델명\n      nickname, // 3순위: 별칭\n      modelInfo?.modelName, // 4순위: 기타\n    ].filter((k): k is string => Boolean(k) && k !== \"\");\n\n    // SEO 점수 계산\n    const seoScore = calculateSEOScore(\n      aiOutput.title,\n      aiOutput.excerpt,\n      blockContent,\n      images,\n      seoKeywords // 보강된 키워드 전달\n    );\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        title: aiOutput.title,\n        content: blockContent,\n        metaDescription: aiOutput.excerpt,\n        tags: aiOutput.tags,\n        wordCount: blockContent.replace(/<[^>]*>/g, \"\").length,\n        seoScore,\n        images,\n      },\n    });\n  } catch (error: any) {\n    console.error(\"API Error:\", error);\n    return NextResponse.json(\n      { success: false, error: error.message || \"Internal Server Error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}